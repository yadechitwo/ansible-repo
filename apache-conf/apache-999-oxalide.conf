#
# Generated by Chef for cds.aws-eu-west-1-web.www-01.adm
#

# ports
ServerName localhost

# http
Listen 80

# SSL Configuration
# - SSL not enabled

# perf
HostnameLookups off
ListenBacklog 1024

# timeout & keepalived
Timeout 600
KeepAlive Off
MaxKeepAliveRequests 100
KeepAliveTimeout 3

# secu
TraceEnable             Off
ServerTokens    Prod
ServerSignature Off

# conf prefork
<IfModule mpm_prefork_module>
    StartServers          32
    MinSpareServers       16
    MaxSpareServers       80
    ServerLimit           150
    MaxRequestWorkers     150
    MaxRequestsPerChild   10000
</IfModule>

# conf worker
<IfModule mpm_worker_module>
    StartServers          32
    MinSpareServers       16
    MaxSpareServers       80
    ServerLimit           150
    MaxRequestWorkers     150
    MaxRequestsPerChild   10000
</IfModule>

LimitRequestFieldSize   8190
LimitRequestLine        8190

# logs
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" PID %{pid}P TimeTaken %D" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

ErrorLog /space/logs/apache/error.log

<Directory /space/www/>
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
</Directory>

# Custom conf
LogFormat "%a %l %u %t '%r' %>s %b '%{Referer}i' '%{User-Agent}i' PID %{pid}P TimeTaken %D" combined
RemoteIPHeader X-Forwarded-For
RemoteIPInternalProxy 10.133.72.0/24

# Error customise
<Directory /space/www/default/errors/>
        Order Allow,Deny
        Allow from all
</Directory>

Alias  /OxaErrorsManager /space/www/default/errors/

ErrorDocument 401 /OxaErrorsManager/401.html
ErrorDocument 403 /OxaErrorsManager/403.html
ErrorDocument 404 /OxaErrorsManager/404.html
ErrorDocument 500 /OxaErrorsManager/500.html
ErrorDocument 503 /OxaErrorsManager/503.html


# REMOVE THIS ONE - ITS AN EXAMPLE
# conf prefork
#<IfModule mpm_prefork_module>
#    StartServers          10
#    MinSpareServers       10
#    MaxSpareServers       80
#    ServerLimit           256
#    MaxRequestWorkers     256
#    MaxRequestsPerChild   10000
#</IfModule>